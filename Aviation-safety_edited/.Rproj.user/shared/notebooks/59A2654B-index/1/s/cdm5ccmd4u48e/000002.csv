"0","## create data frame. This will be used as data points in barchart"
"0",""
"0","df <- data.frame(Type, Values, Year)"
"0",""
"0","GA <- df[df$Type == ""General Aviation"", 2]"
"0","COMM <- df[df$Type == ""Commercial"", 2]"
"0","  d <- data.frame(GA, COMM)"
"0","  colnames(d)<- c('General Aviation', 'Commercial')"
"0",""
"0","  m.d <- melt(d)  "
"0",""
"0","# create values for error bars and means. place into data frame. This will give the size of barchart and the length of error bars  "
"0","se <- function(x){sd(x)/sqrt(length(x))}"
"0",""
"0","  ses <- c(se((COMM)), se(na.omit(GA)))"
"0","  means <- c(mean((COMM)),mean(na.omit(GA)))"
"0","  Type <- unique(df$Type)"
"0",""
"0","dat_sum <- data.frame(Type, means, ses)"
"0",""
"0",""
"0",""
"0","## format barchart"
"0"," "
"0","p1 <-  ggplot(dat_sum, aes(y=means,x=Type)) +  geom_bar(stat=""identity"",width=0.4, colour = c(""palegreen3"", ""blue""), fill=c(""palegreen3"", ""cornflowerblue"")) + "
"0","       scale_fill_manual(values=c(""palegreen3"", ""cornflowerblue"")) + geom_errorbar(stat=""identity"",width=0.2, ymin=means-ses,ymax=means+ses, size = 1.5) + theme_classic() +"
"0","       geom_point(data = m.d, aes(variable, value), position = ""jitter"") + labs(title = ""Yearly Rates per Aviation Type"", caption = ""*Note: error bars are standard errors"") + "
"0","       ylab(""Fatality Rate: Fatal Accident / 100,000 Flight Hours"") + theme(axis.text=element_text(size=12), axis.title.x = element_blank())"
"0"," "
"0",""
"0","## fomart pie chart"
"0",""
"0","p2 <-  ggplot(dat_sum, aes(x="""", y=means, fill=Type))+ geom_bar(width = 1, stat = ""identity"")"
"0","p2 <- p2 + coord_polar(theta = ""y"") "
"0","  "
"0"," blank_theme <- theme_minimal()+"
"0","  theme("
"0","  axis.text = element_blank(),"
"0","  axis.title.x = element_blank(),"
"0","  axis.title.y = element_blank(),"
"0","  panel.border = element_blank(),"
"0","  panel.grid=element_blank(),"
"0","  axis.ticks = element_blank(),"
"0","  plot.title=element_text(size=14, face=""bold"")"
"0","  )"
"0",""
"0","p2 <- p2 + blank_theme"
"0",""
"0","p2 <- p2  + scale_fill_manual(values=c(""palegreen3"", ""cornflowerblue""))"
"0",""
"0","grid.arrange(p1, p2, nrow = 1)"
"0",""
